# UDP 转发工具套件

## 介绍
本项目主打大力出奇迹，没有处理重传，适合用来转发WireGuard的数据包。

## 概述
本工具包含两个独立的UDP转发程序，分别实现不同的网络数据中转场景：

1. **Client** - 多路分发代理  
   监听指定端口，将接收到的数据同时转发到多个目标地址，并支持双向数据回传。

2. **Server** - 聚合转发服务  
   聚合来自多个客户端的数据，统一转发到单个目标地址，并实现响应数据广播和连接状态维护。

---

## Client 程序

### 功能特性
- 从指定UDP端口监听接收数据
- 支持同时向多个目标地址转发数据
- 自动维护转发连接状态
- 支持双向数据回传（转发响应返回原始发送方）
- 可配置连接重试和健康检查

### 配置文件说明 (`config.json`)
```json
{
    "listen_addr": "127.0.0.1:10001",  // 监听地址（客户端入口）
    "forwarders": [                    // 转发目标地址列表
        "a.com:1111",
        "b.com:2222"
    ],
    "queue_size": 1024,               // 处理队列容量
    "buffer_size": 1500,              // 数据包缓冲区大小
    "reconnect_interval": 5,          // 连接重试间隔（秒）
    "connection_check_time": 30       // 连接健康检查间隔（秒）
}
```

### 数据流向
```
发送方 -> [Client监听端口] 
        ├─> 目标地址1
        └─> 目标地址2
        
目标地址响应 -> [Client监听端口] -> 原发送方
```

---

## Server 程序

### 功能特性
- 接收来自多个客户端的UDP数据
- 统一转发到单个目标地址
- 自动维护客户端地址列表
- 支持响应数据广播
- 自动清理闲置连接（5分钟无活动）

### 配置文件说明 (`config.json`)
```json
{
    "listen_addr": "0.0.0.0:6000",    // 监听地址（服务端入口）
    "buffer_size": 1500,              // 数据包缓冲区大小
    "timeout": 300,                   // 客户端超时时间（秒）（5分钟=300）
    "forward_addr": "127.0.0.1:6001", // 唯一转发目标地址
    "replace_old_conns": true         // 当出现相同ip时是否替换旧连接
}
```

### 数据流向
```
客户端A -> [Server监听端口] -> 目标地址
客户端B -> [Server监听端口] ↗

目标地址响应 -> [Server监听端口] 
            ├─> 客户端A
            └─> 客户端B
```

---

## 使用指南

### 运行命令
```bash
# 启动Client，config.json为配置文件
./client

# 启动Server，config.json为配置文件
./server
```


---
