{
    "buffer_size": 1500,
    "services": [
        {
            "type": "listen",
            "tag": "client_listen",
            "listen_addr": "0.0.0.0:6000",
            "timeout": 120,
            "replace_old_mapping": true,
            "detour": ["packet_filter"]
        },
        {
            "type": "filter",
            "tag": "packet_filter",
            "use_proto_detectors": ["dns"],
            "detour": ["dns_forward"]
        },
        {
            "type": "forward",
            "tag": "dns_forward",
            "forwarders": ["8.8.8.8:53", "1.1.1.1:53"],
            "detour": ["client_listen"]
        },
        {
            "type": "forward",
            "tag": "default_forward",
            "forwarders": ["default-server.com:12345"],
            "detour": ["client_listen"]
        }
    ],
    "protocol_detectors": {
        "wg_keepalive": {
            "signatures": [
                {
                    "offset": 2,
                    "bytes": "0400000062",
                    "mask": "FFFFFFFFFF",
                    "hex": true,
                    "length": { "min": 32, "max": 32 }
                }
            ],
            "match_logic": "AND",
            "description": "This is a Keepalive message"
        }
    }
}