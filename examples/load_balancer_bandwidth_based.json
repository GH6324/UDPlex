{
    "buffer_size": 1500,
    "queue_size": 10240,
    "worker_count": 4,
    "logging": {
        "level": "debug", 
        "format": "console",
        "output_path": "stdout",
        "caller": true
    },
    "services": [
        {
            "type": "listen",
            "tag": "client_listen",
            "listen_addr": "0.0.0.0:5202",
            "timeout": 120,
            "replace_old_mapping": true,
            "detour": [
                "load_balancer"
            ]
        },
        {
            "type": "load_balancer",
            "tag": "load_balancer",
            "sample_interval": "2s",
            "window_size": "20s",
            "detour": [
                {
                    "rule": "$bps < 1000000",
                    "target": "low_bandwidth_server"
                },
                {
                    "rule": "$bps >= 1000000 && $bps < 5000000",
                    "target": "medium_bandwidth_server"
                },
                {
                    "rule": "$bps >= 5000000 || $pps > 500",
                    "target": "high_performance_server"
                },
                {
                    "rule": "$seq % 4 == 0",
                    "target": "backup_server"
                }
            ]
        },
        {
            "type": "forward",
            "tag": "low_bandwidth_server",
            "forwarders": [
                "192.168.1.10:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        },
        {
            "type": "forward",
            "tag": "medium_bandwidth_server",
            "forwarders": [
                "192.168.1.11:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        },
        {
            "type": "forward",
            "tag": "high_performance_server",
            "forwarders": [
                "192.168.1.12:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        },
        {
            "type": "forward",
            "tag": "backup_server",
            "forwarders": [
                "192.168.1.13:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        }
    ]
}
