{
    "buffer_size": 1500,
    "queue_size": 10240,
    "worker_count": 4,
    "logging": {
        "level": "debug",
        "format": "console",
        "output_path": "stdout",
        "caller": true
    },
    "services": [
        {
            "type": "listen",
            "tag": "client_listen",
            "listen_addr": "0.0.0.0:5202",
            "timeout": 120,
            "replace_old_mapping": true,
            "detour": [
                "load_balancer"
            ]
        },
        {
            "type": "load_balancer",
            "tag": "load_balancer",
            "sample_interval": "1s",
            "window_size": "10s",
            "detour": [
                {
                    "rule": "$seq % 3 == 0",
                    "target": "server1"
                },
                {
                    "rule": "$seq % 3 == 1",
                    "target": "server2"
                },
                {
                    "rule": "$seq % 3 == 2 || $pps > 1000",
                    "target": "server3"
                }
            ]
        },
        {
            "type": "forward",
            "tag": "server1",
            "forwarders": [
                "192.168.1.10:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        },
        {
            "type": "forward",
            "tag": "server2",
            "forwarders": [
                "192.168.1.11:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        },
        {
            "type": "forward",
            "tag": "server3",
            "forwarders": [
                "192.168.1.12:5201"
            ],
            "reconnect_interval": 5,
            "connection_check_time": 30,
            "send_keepalive": true,
            "detour": [
                "client_listen"
            ]
        }
    ]
}
